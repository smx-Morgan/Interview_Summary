### redis分布式锁

分布式锁，简单来说就是在分布式环境下不同实例之间抢一把锁。和普通的锁比起来，也就是抢锁的从线程（协程）变成了实例。Redis 实现分布式锁，就是利用setnx命令，确保可以排他地设置一个键值对。如果说如果说他看来运他执行那个命令失败了。就说明这个锁已经被其他的户端持有了，这样的话他就需要等待。成功获取锁并且执行完临界区操作之后，便可以用del命令在redis删除这个key，实现释放锁的目的。

### 扩展

**分布式锁优化**

设置锁的过期时间，考虑使用续约的办法。加锁可能遇到偶发性的失败，在这种情况下，可以尝试重试。